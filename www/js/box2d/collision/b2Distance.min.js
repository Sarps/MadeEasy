var b2Distance=Class.create();b2Distance.prototype={initialize:function(){}},b2Distance.ProcessTwo=function(t,e,r,a,y){var x=-y[1].x,n=-y[1].y,i=y[0].x-y[1].x,s=y[0].y-y[1].y,V=Math.sqrt(i*i+s*s);i/=V,s/=V;var S=x*i+n*s;return 0>=S||V<Number.MIN_VALUE?(t.SetV(r[1]),e.SetV(a[1]),r[0].SetV(r[1]),a[0].SetV(a[1]),y[0].SetV(y[1]),1):(S/=V,t.x=r[1].x+S*(r[0].x-r[1].x),t.y=r[1].y+S*(r[0].y-r[1].y),e.x=a[1].x+S*(a[0].x-a[1].x),e.y=a[1].y+S*(a[0].y-a[1].y),2)},b2Distance.ProcessThree=function(t,e,r,a,y){var x=y[0].x,n=y[0].y,i=y[1].x,s=y[1].y,V=y[2].x,S=y[2].y,o=i-x,c=s-n,b=V-x,u=S-n,v=V-i,f=S-s,D=-(x*b+n*u),_=V*b+S*u,M=-(i*v+s*f),h=V*v+S*f;if(0>=_&&0>=h)return t.SetV(r[2]),e.SetV(a[2]),r[0].SetV(r[2]),a[0].SetV(a[2]),y[0].SetV(y[2]),1;var p=o*u-c*b,I=p*(x*s-n*i),w=p*(i*S-s*V);if(0>=w&&M>=0&&h>=0){var A=M/(M+h);return t.x=r[1].x+A*(r[2].x-r[1].x),t.y=r[1].y+A*(r[2].y-r[1].y),e.x=a[1].x+A*(a[2].x-a[1].x),e.y=a[1].y+A*(a[2].y-a[1].y),r[0].SetV(r[2]),a[0].SetV(a[2]),y[0].SetV(y[2]),2}var g=p*(V*n-S*x);if(0>=g&&D>=0&&_>=0){var A=D/(D+_);return t.x=r[0].x+A*(r[2].x-r[0].x),t.y=r[0].y+A*(r[2].y-r[0].y),e.x=a[0].x+A*(a[2].x-a[0].x),e.y=a[0].y+A*(a[2].y-a[0].y),r[1].SetV(r[2]),a[1].SetV(a[2]),y[1].SetV(y[2]),2}var m=w+g+I;m=1/m;var G=w*m,J=g*m,K=1-G-J;return t.x=G*r[0].x+J*r[1].x+K*r[2].x,t.y=G*r[0].y+J*r[1].y+K*r[2].y,e.x=G*a[0].x+J*a[1].x+K*a[2].x,e.y=G*a[0].y+J*a[1].y+K*a[2].y,3},b2Distance.InPoinsts=function(t,e,r){for(var a=0;r>a;++a)if(t.x==e[a].x&&t.y==e[a].y)return!0;return!1},b2Distance.Distance=function(t,e,r,a){var y=new Array(3),x=new Array(3),n=new Array(3),i=0;t.SetV(r.m_position),e.SetV(a.m_position);for(var s=0,V=20,S=0;V>S;++S){var o=e.x-t.x,c=e.y-t.y,b=r.Support(o,c),u=a.Support(-o,-c);s=o*o+c*c;var v=u.x-b.x,f=u.y-b.y;if(s-b2Dot(o*v+c*f)<=.01*s)return 0==i&&(t.SetV(b),e.SetV(u)),b2Distance.g_GJK_Iterations=S,Math.sqrt(s);switch(i){case 0:y[0].SetV(b),x[0].SetV(u),n[0]=w,t.SetV(y[0]),e.SetV(x[0]),++i;break;case 1:y[1].SetV(b),x[1].SetV(u),n[1].x=v,n[1].y=f,i=b2Distance.ProcessTwo(t,e,y,x,n);break;case 2:y[2].SetV(b),x[2].SetV(u),n[2].x=v,n[2].y=f,i=b2Distance.ProcessThree(t,e,y,x,n)}if(3==i)return b2Distance.g_GJK_Iterations=S,0;for(var D=-Number.MAX_VALUE,_=0;i>_;++_)D=b2Math.b2Max(D,n[_].x*n[_].x+n[_].y*n[_].y);if(3==i||s<=100*Number.MIN_VALUE*D)return b2Distance.g_GJK_Iterations=S,Math.sqrt(s)}return b2Distance.g_GJK_Iterations=V,Math.sqrt(s)},b2Distance.g_GJK_Iterations=0;