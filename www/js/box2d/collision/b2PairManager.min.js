var b2PairManager=Class.create();b2PairManager.prototype={initialize:function(){var a=0;for(this.m_hashTable=new Array(b2Pair.b2_tableCapacity),a=0;a<b2Pair.b2_tableCapacity;++a)this.m_hashTable[a]=b2Pair.b2_nullPair;for(this.m_pairs=new Array(b2Settings.b2_maxPairs),a=0;a<b2Settings.b2_maxPairs;++a)this.m_pairs[a]=new b2Pair;for(this.m_pairBuffer=new Array(b2Settings.b2_maxPairs),a=0;a<b2Settings.b2_maxPairs;++a)this.m_pairBuffer[a]=new b2BufferedPair;for(a=0;a<b2Settings.b2_maxPairs;++a)this.m_pairs[a].proxyId1=b2Pair.b2_nullProxy,this.m_pairs[a].proxyId2=b2Pair.b2_nullProxy,this.m_pairs[a].userData=null,this.m_pairs[a].status=0,this.m_pairs[a].next=a+1;this.m_pairs[b2Settings.b2_maxPairs-1].next=b2Pair.b2_nullPair,this.m_pairCount=0},Initialize:function(a,r){this.m_broadPhase=a,this.m_callback=r},AddBufferedPair:function(a,r){var i=this.AddPair(a,r);0==i.IsBuffered()&&(i.SetBuffered(),this.m_pairBuffer[this.m_pairBufferCount].proxyId1=i.proxyId1,this.m_pairBuffer[this.m_pairBufferCount].proxyId2=i.proxyId2,++this.m_pairBufferCount),i.ClearRemoved(),b2BroadPhase.s_validate&&this.ValidateBuffer()},RemoveBufferedPair:function(a,r){var i=this.Find(a,r);null!=i&&(0==i.IsBuffered()&&(i.SetBuffered(),this.m_pairBuffer[this.m_pairBufferCount].proxyId1=i.proxyId1,this.m_pairBuffer[this.m_pairBufferCount].proxyId2=i.proxyId2,++this.m_pairBufferCount),i.SetRemoved(),b2BroadPhase.s_validate&&this.ValidateBuffer())},Commit:function(){var a=0,r=0,i=this.m_broadPhase.m_proxyPool;for(a=0;a<this.m_pairBufferCount;++a){var t=this.Find(this.m_pairBuffer[a].proxyId1,this.m_pairBuffer[a].proxyId2);t.ClearBuffered();var e=i[t.proxyId1],s=i[t.proxyId2];t.IsRemoved()?(1==t.IsFinal()&&this.m_callback.PairRemoved(e.userData,s.userData,t.userData),this.m_pairBuffer[r].proxyId1=t.proxyId1,this.m_pairBuffer[r].proxyId2=t.proxyId2,++r):0==t.IsFinal()&&(t.userData=this.m_callback.PairAdded(e.userData,s.userData),t.SetFinal())}for(a=0;r>a;++a)this.RemovePair(this.m_pairBuffer[a].proxyId1,this.m_pairBuffer[a].proxyId2);this.m_pairBufferCount=0,b2BroadPhase.s_validate&&this.ValidateTable()},AddPair:function(a,r){if(a>r){var i=a;a=r,r=i}var t=b2PairManager.Hash(a,r)&b2Pair.b2_tableMask,e=e=this.FindHash(a,r,t);if(null!=e)return e;var s=this.m_freePair;return e=this.m_pairs[s],this.m_freePair=e.next,e.proxyId1=a,e.proxyId2=r,e.status=0,e.userData=null,e.next=this.m_hashTable[t],this.m_hashTable[t]=s,++this.m_pairCount,e},RemovePair:function(a,r){if(a>r){var i=a;a=r,r=i}for(var t=b2PairManager.Hash(a,r)&b2Pair.b2_tableMask,e=this.m_hashTable[t],s=null;e!=b2Pair.b2_nullPair;){if(b2PairManager.Equals(this.m_pairs[e],a,r)){var n=e;s?s.next=this.m_pairs[e].next:this.m_hashTable[t]=this.m_pairs[e].next;var u=this.m_pairs[n],f=u.userData;return u.next=this.m_freePair,u.proxyId1=b2Pair.b2_nullProxy,u.proxyId2=b2Pair.b2_nullProxy,u.userData=null,u.status=0,this.m_freePair=n,--this.m_pairCount,f}s=this.m_pairs[e],e=s.next}return null},Find:function(a,r){if(a>r){var i=a;a=r,r=i}var t=b2PairManager.Hash(a,r)&b2Pair.b2_tableMask;return this.FindHash(a,r,t)},FindHash:function(a,r,i){for(var t=this.m_hashTable[i];t!=b2Pair.b2_nullPair&&0==b2PairManager.Equals(this.m_pairs[t],a,r);)t=this.m_pairs[t].next;return t==b2Pair.b2_nullPair?null:this.m_pairs[t]},ValidateBuffer:function(){},ValidateTable:function(){},m_broadPhase:null,m_callback:null,m_pairs:null,m_freePair:0,m_pairCount:0,m_pairBuffer:null,m_pairBufferCount:0,m_hashTable:null},b2PairManager.Hash=function(a,r){var i=r<<16&4294901760|a;return i=~i+(i<<15&4294934528),i^=i>>12&1048575,i+=i<<2&4294967292,i^=i>>4&268435455,i=2057*i,i^=i>>16&65535},b2PairManager.Equals=function(a,r,i){return a.proxyId1==r&&a.proxyId2==i},b2PairManager.EqualsPair=function(a,r){return a.proxyId1==r.proxyId1&&a.proxyId2==r.proxyId2};