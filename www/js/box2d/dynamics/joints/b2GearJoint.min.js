var b2GearJoint=Class.create();Object.extend(b2GearJoint.prototype,b2Joint.prototype),Object.extend(b2GearJoint.prototype,{GetAnchor1:function(){var i=this.m_body1.m_R;return new b2Vec2(this.m_body1.m_position.x+(i.col1.x*this.m_localAnchor1.x+i.col2.x*this.m_localAnchor1.y),this.m_body1.m_position.y+(i.col1.y*this.m_localAnchor1.x+i.col2.y*this.m_localAnchor1.y))},GetAnchor2:function(){var i=this.m_body2.m_R;return new b2Vec2(this.m_body2.m_position.x+(i.col1.x*this.m_localAnchor2.x+i.col2.x*this.m_localAnchor2.y),this.m_body2.m_position.y+(i.col1.y*this.m_localAnchor2.x+i.col2.y*this.m_localAnchor2.y))},GetReactionForce:function(){return new b2Vec2},GetReactionTorque:function(){return 0},GetRatio:function(){return this.m_ratio},initialize:function(i){this.m_node1=new b2JointNode,this.m_node2=new b2JointNode,this.m_type=i.type,this.m_prev=null,this.m_next=null,this.m_body1=i.body1,this.m_body2=i.body2,this.m_collideConnected=i.collideConnected,this.m_islandFlag=!1,this.m_userData=i.userData,this.m_groundAnchor1=new b2Vec2,this.m_groundAnchor2=new b2Vec2,this.m_localAnchor1=new b2Vec2,this.m_localAnchor2=new b2Vec2,this.m_J=new b2Jacobian,this.m_revolute1=null,this.m_prismatic1=null,this.m_revolute2=null,this.m_prismatic2=null;var t,o;this.m_ground1=i.joint1.m_body1,this.m_body1=i.joint1.m_body2,i.joint1.m_type==b2Joint.e_revoluteJoint?(this.m_revolute1=i.joint1,this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2),t=this.m_revolute1.GetJointAngle()):(this.m_prismatic1=i.joint1,this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2),t=this.m_prismatic1.GetJointTranslation()),this.m_ground2=i.joint2.m_body1,this.m_body2=i.joint2.m_body2,i.joint2.m_type==b2Joint.e_revoluteJoint?(this.m_revolute2=i.joint2,this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2),o=this.m_revolute2.GetJointAngle()):(this.m_prismatic2=i.joint2,this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2),o=this.m_prismatic2.GetJointTranslation()),this.m_ratio=i.ratio,this.m_constant=t+this.m_ratio*o,this.m_impulse=0},PrepareVelocitySolver:function(){var i,t,o,m,n,l,_,s=this.m_ground1,e=this.m_ground2,r=this.m_body1,a=this.m_body2,h=0;this.m_J.SetZero(),this.m_revolute1?(this.m_J.angular1=-1,h+=r.m_invI):(n=s.m_R,l=this.m_prismatic1.m_localXAxis1,i=n.col1.x*l.x+n.col2.x*l.y,t=n.col1.y*l.x+n.col2.y*l.y,n=r.m_R,o=n.col1.x*this.m_localAnchor1.x+n.col2.x*this.m_localAnchor1.y,m=n.col1.y*this.m_localAnchor1.x+n.col2.y*this.m_localAnchor1.y,_=o*t-m*i,this.m_J.linear1.Set(-i,-t),this.m_J.angular1=-_,h+=r.m_invMass+r.m_invI*_*_),this.m_revolute2?(this.m_J.angular2=-this.m_ratio,h+=this.m_ratio*this.m_ratio*a.m_invI):(n=e.m_R,l=this.m_prismatic2.m_localXAxis1,i=n.col1.x*l.x+n.col2.x*l.y,t=n.col1.y*l.x+n.col2.y*l.y,n=a.m_R,o=n.col1.x*this.m_localAnchor2.x+n.col2.x*this.m_localAnchor2.y,m=n.col1.y*this.m_localAnchor2.x+n.col2.y*this.m_localAnchor2.y,_=o*t-m*i,this.m_J.linear2.Set(-this.m_ratio*i,-this.m_ratio*t),this.m_J.angular2=-this.m_ratio*_,h+=this.m_ratio*this.m_ratio*(a.m_invMass+a.m_invI*_*_)),this.m_mass=1/h,r.m_linearVelocity.x+=r.m_invMass*this.m_impulse*this.m_J.linear1.x,r.m_linearVelocity.y+=r.m_invMass*this.m_impulse*this.m_J.linear1.y,r.m_angularVelocity+=r.m_invI*this.m_impulse*this.m_J.angular1,a.m_linearVelocity.x+=a.m_invMass*this.m_impulse*this.m_J.linear2.x,a.m_linearVelocity.y+=a.m_invMass*this.m_impulse*this.m_J.linear2.y,a.m_angularVelocity+=a.m_invI*this.m_impulse*this.m_J.angular2},SolveVelocityConstraints:function(){var i=this.m_body1,t=this.m_body2,o=this.m_J.Compute(i.m_linearVelocity,i.m_angularVelocity,t.m_linearVelocity,t.m_angularVelocity),m=-this.m_mass*o;this.m_impulse+=m,i.m_linearVelocity.x+=i.m_invMass*m*this.m_J.linear1.x,i.m_linearVelocity.y+=i.m_invMass*m*this.m_J.linear1.y,i.m_angularVelocity+=i.m_invI*m*this.m_J.angular1,t.m_linearVelocity.x+=t.m_invMass*m*this.m_J.linear2.x,t.m_linearVelocity.y+=t.m_invMass*m*this.m_J.linear2.y,t.m_angularVelocity+=t.m_invI*m*this.m_J.angular2},SolvePositionConstraints:function(){var i,t,o=0,m=this.m_body1,n=this.m_body2;i=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation(),t=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation();var l=this.m_constant-(i+this.m_ratio*t),_=-this.m_mass*l;return m.m_position.x+=m.m_invMass*_*this.m_J.linear1.x,m.m_position.y+=m.m_invMass*_*this.m_J.linear1.y,m.m_rotation+=m.m_invI*_*this.m_J.angular1,n.m_position.x+=n.m_invMass*_*this.m_J.linear2.x,n.m_position.y+=n.m_invMass*_*this.m_J.linear2.y,n.m_rotation+=n.m_invI*_*this.m_J.angular2,m.m_R.Set(m.m_rotation),n.m_R.Set(n.m_rotation),o<b2Settings.b2_linearSlop},m_ground1:null,m_ground2:null,m_revolute1:null,m_prismatic1:null,m_revolute2:null,m_prismatic2:null,m_groundAnchor1:new b2Vec2,m_groundAnchor2:new b2Vec2,m_localAnchor1:new b2Vec2,m_localAnchor2:new b2Vec2,m_J:new b2Jacobian,m_constant:null,m_ratio:null,m_mass:null,m_impulse:null});