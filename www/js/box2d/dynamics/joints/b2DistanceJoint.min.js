var b2DistanceJoint=Class.create();Object.extend(b2DistanceJoint.prototype,b2Joint.prototype),Object.extend(b2DistanceJoint.prototype,{initialize:function(o){this.m_node1=new b2JointNode,this.m_node2=new b2JointNode,this.m_type=o.type,this.m_prev=null,this.m_next=null,this.m_body1=o.body1,this.m_body2=o.body2,this.m_collideConnected=o.collideConnected,this.m_islandFlag=!1,this.m_userData=o.userData,this.m_localAnchor1=new b2Vec2,this.m_localAnchor2=new b2Vec2,this.m_u=new b2Vec2;var i,t,m;i=this.m_body1.m_R,t=o.anchorPoint1.x-this.m_body1.m_position.x,m=o.anchorPoint1.y-this.m_body1.m_position.y,this.m_localAnchor1.x=t*i.col1.x+m*i.col1.y,this.m_localAnchor1.y=t*i.col2.x+m*i.col2.y,i=this.m_body2.m_R,t=o.anchorPoint2.x-this.m_body2.m_position.x,m=o.anchorPoint2.y-this.m_body2.m_position.y,this.m_localAnchor2.x=t*i.col1.x+m*i.col1.y,this.m_localAnchor2.y=t*i.col2.x+m*i.col2.y,t=o.anchorPoint2.x-o.anchorPoint1.x,m=o.anchorPoint2.y-o.anchorPoint1.y,this.m_length=Math.sqrt(t*t+m*m),this.m_impulse=0},PrepareVelocitySolver:function(){var o;o=this.m_body1.m_R;var i=o.col1.x*this.m_localAnchor1.x+o.col2.x*this.m_localAnchor1.y,t=o.col1.y*this.m_localAnchor1.x+o.col2.y*this.m_localAnchor1.y;o=this.m_body2.m_R;var m=o.col1.x*this.m_localAnchor2.x+o.col2.x*this.m_localAnchor2.y,s=o.col1.y*this.m_localAnchor2.x+o.col2.y*this.m_localAnchor2.y;this.m_u.x=this.m_body2.m_position.x+m-this.m_body1.m_position.x-i,this.m_u.y=this.m_body2.m_position.y+s-this.m_body1.m_position.y-t;var _=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);_>b2Settings.b2_linearSlop?this.m_u.Multiply(1/_):this.m_u.SetZero();var h=i*this.m_u.y-t*this.m_u.x,n=m*this.m_u.y-s*this.m_u.x;if(this.m_mass=this.m_body1.m_invMass+this.m_body1.m_invI*h*h+this.m_body2.m_invMass+this.m_body2.m_invI*n*n,this.m_mass=1/this.m_mass,b2World.s_enableWarmStarting){var l=this.m_impulse*this.m_u.x,y=this.m_impulse*this.m_u.y;this.m_body1.m_linearVelocity.x-=this.m_body1.m_invMass*l,this.m_body1.m_linearVelocity.y-=this.m_body1.m_invMass*y,this.m_body1.m_angularVelocity-=this.m_body1.m_invI*(i*y-t*l),this.m_body2.m_linearVelocity.x+=this.m_body2.m_invMass*l,this.m_body2.m_linearVelocity.y+=this.m_body2.m_invMass*y,this.m_body2.m_angularVelocity+=this.m_body2.m_invI*(m*y-s*l)}else this.m_impulse=0},SolveVelocityConstraints:function(){var o;o=this.m_body1.m_R;var i=o.col1.x*this.m_localAnchor1.x+o.col2.x*this.m_localAnchor1.y,t=o.col1.y*this.m_localAnchor1.x+o.col2.y*this.m_localAnchor1.y;o=this.m_body2.m_R;var m=o.col1.x*this.m_localAnchor2.x+o.col2.x*this.m_localAnchor2.y,s=o.col1.y*this.m_localAnchor2.x+o.col2.y*this.m_localAnchor2.y,_=this.m_body1.m_linearVelocity.x+-this.m_body1.m_angularVelocity*t,h=this.m_body1.m_linearVelocity.y+this.m_body1.m_angularVelocity*i,n=this.m_body2.m_linearVelocity.x+-this.m_body2.m_angularVelocity*s,l=this.m_body2.m_linearVelocity.y+this.m_body2.m_angularVelocity*m,y=this.m_u.x*(n-_)+this.m_u.y*(l-h),c=-this.m_mass*y;this.m_impulse+=c;var a=c*this.m_u.x,e=c*this.m_u.y;this.m_body1.m_linearVelocity.x-=this.m_body1.m_invMass*a,this.m_body1.m_linearVelocity.y-=this.m_body1.m_invMass*e,this.m_body1.m_angularVelocity-=this.m_body1.m_invI*(i*e-t*a),this.m_body2.m_linearVelocity.x+=this.m_body2.m_invMass*a,this.m_body2.m_linearVelocity.y+=this.m_body2.m_invMass*e,this.m_body2.m_angularVelocity+=this.m_body2.m_invI*(m*e-s*a)},SolvePositionConstraints:function(){var o;o=this.m_body1.m_R;var i=o.col1.x*this.m_localAnchor1.x+o.col2.x*this.m_localAnchor1.y,t=o.col1.y*this.m_localAnchor1.x+o.col2.y*this.m_localAnchor1.y;o=this.m_body2.m_R;var m=o.col1.x*this.m_localAnchor2.x+o.col2.x*this.m_localAnchor2.y,s=o.col1.y*this.m_localAnchor2.x+o.col2.y*this.m_localAnchor2.y,_=this.m_body2.m_position.x+m-this.m_body1.m_position.x-i,h=this.m_body2.m_position.y+s-this.m_body1.m_position.y-t,n=Math.sqrt(_*_+h*h);_/=n,h/=n;var l=n-this.m_length;l=b2Math.b2Clamp(l,-b2Settings.b2_maxLinearCorrection,b2Settings.b2_maxLinearCorrection);var y=-this.m_mass*l;this.m_u.Set(_,h);var c=y*this.m_u.x,a=y*this.m_u.y;return this.m_body1.m_position.x-=this.m_body1.m_invMass*c,this.m_body1.m_position.y-=this.m_body1.m_invMass*a,this.m_body1.m_rotation-=this.m_body1.m_invI*(i*a-t*c),this.m_body2.m_position.x+=this.m_body2.m_invMass*c,this.m_body2.m_position.y+=this.m_body2.m_invMass*a,this.m_body2.m_rotation+=this.m_body2.m_invI*(m*a-s*c),this.m_body1.m_R.Set(this.m_body1.m_rotation),this.m_body2.m_R.Set(this.m_body2.m_rotation),b2Math.b2Abs(l)<b2Settings.b2_linearSlop},GetAnchor1:function(){return b2Math.AddVV(this.m_body1.m_position,b2Math.b2MulMV(this.m_body1.m_R,this.m_localAnchor1))},GetAnchor2:function(){return b2Math.AddVV(this.m_body2.m_position,b2Math.b2MulMV(this.m_body2.m_R,this.m_localAnchor2))},GetReactionForce:function(o){var i=new b2Vec2;return i.SetV(this.m_u),i.Multiply(this.m_impulse*o),i},GetReactionTorque:function(){return 0},m_localAnchor1:new b2Vec2,m_localAnchor2:new b2Vec2,m_u:new b2Vec2,m_impulse:null,m_mass:null,m_length:null});